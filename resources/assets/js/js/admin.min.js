$(document).ready(function() {
    //jQuery.noConflict();
    //$('.sidebar').scrollbar();
    //$('.dashboard_check_list').scrollbar();
 

    if (window.location.pathname == '/auth/register') {
        console.log(localStorage.getItem("trialEmail"));
        if (localStorage.getItem("trialEmail") !== null) {
            var email = localStorage.getItem("trialEmail");
            $('#email').val(email);
            localStorage.removeItem('trialEmail');
        }
    }
    //Скрытие label авторизация/регистрация
    var input = $('.sing_in_form .sign_form_row input');

    for (var i = 0; i < input.length; i++) {
        if (input[i].id) {
            var object = $('#' + input[i].id);
            (object.val().trim() != '' ? object.next('label').addClass('none') : object.next('label').removeClass('none'));            
        }
    }

    $(input).change(function() {
        if($(this).val() !='') {
            $(this).next('label').addClass('none');
        } else {
            $(this).next('label').removeClass('none');
        }
    });

    //Показать подсказку на значок вопроса

    $('.question_icon').click(function(e) {
        e.preventDefault();
        $(this).next('.question_fon').toggleClass('show_fon').next('.question_block_hidden').toggleClass('open_question');
    });

    // $(document).on('click touchstart', function(e) {
    //     if (!$(e.target).closest(".question").length) {
    //         $('.question_block_hidden').removeClass('open_question');
    //     }
    //     e.stopPropagation();
    // });

    $('.question_fon').click(function(e) {
        e.preventDefault();
        $(this).next('.question_block_hidden').removeClass('open_question');
        $(this).removeClass('show_fon');
    });

    $('.question_block_ok').click(function() {
        $('.question_block_hidden').removeClass('open_question');
        $('.question_fon').removeClass('show_fon');
        return false;
    });

    //Показать модальное окно
    $('.add_domain button, #welcome-add').click(function() {

        $('.add_domain_modal').fadeIn('fast', function(){
            //$('.add_domain_modal').addClass('show_modal');            
        });
       //$('body, html').addClass('overflow');
       return false;
    });

    //Скрыть модальное окно
    $('.domain_modal_fon').click(function(){
        $('.add_domain_modal').fadeOut('fast', function(){    
        });
        $('.question_fon').removeClass('show_fon');
        $('.question_block_hidden').removeClass('open_question');
    });
  

    //Показать код скрипта
    $('.view_code_link').click(function() {
        $('.code_block_content').slideDown();
        $(this).addClass('opacity');
        $('.hide_code_link').removeClass('opacity');
        return false;
    });

    //Скрыть код скрипта
    $('.hide_code_link').click(function() {
        $('.code_block_content').slideUp();
        $(this).addClass('opacity');
        $('.view_code_link').removeClass('opacity');
        return false;
    });

    $(document).on('click', '.copy_link', function(){

        console.log('ts');

          const el = document.createElement('textarea');  // Create a <textarea> element
          var src  = document.getElementById('clipboard-src').innerHTML;
          el.value = '<script type="text/javascript" src="'+ src +'"></script>'; // Set its value to the string that you want copied
          el.setAttribute('readonly', '');                // Make it readonly to be tamper-proof
          el.style.position = 'absolute';                 
          el.style.left = '-9999px';                      // Move outside the screen to make it invisible
          document.body.appendChild(el);                  // Append the <textarea> element to the HTML document
          const selected =            
            document.getSelection().rangeCount > 0        // Check if there is any content selected previously
              ? document.getSelection().getRangeAt(0)     // Store selection if found
              : false;                                    // Mark as false to know no selection existed before
          el.select();                                    // Select the <textarea> content
          document.execCommand('copy');                   // Copy - only works as a result of a user action (e.g. click events)
          document.body.removeChild(el);                  // Remove the <textarea> element
          if (selected) {                                 // If a selection existed before copying
            document.getSelection().removeAllRanges();    // Unselect everything on the HTML document
            document.getSelection().addRange(selected);   // Restore the original selection
          }

          document.getElementById('alert-notification').className += ' show';
          setTimeout(function(){
                document.getElementById('alert-notification').className = 'alert-notification';
          }, 3000);

    });

    $(document).on('click', '.copy_key', function(){

        console.log('ts');

          const el = document.createElement('textarea');  // Create a <textarea> element
          var src  = document.getElementById('clipboard-key').innerHTML;
          el.value = src; // Set its value to the string that you want copied
          el.setAttribute('readonly', '');                // Make it readonly to be tamper-proof
          el.style.position = 'absolute';                 
          el.style.left = '-9999px';                      // Move outside the screen to make it invisible
          document.body.appendChild(el);                  // Append the <textarea> element to the HTML document
          const selected =            
            document.getSelection().rangeCount > 0        // Check if there is any content selected previously
              ? document.getSelection().getRangeAt(0)     // Store selection if found
              : false;                                    // Mark as false to know no selection existed before
          el.select();                                    // Select the <textarea> content
          document.execCommand('copy');                   // Copy - only works as a result of a user action (e.g. click events)
          document.body.removeChild(el);                  // Remove the <textarea> element
          if (selected) {                                 // If a selection existed before copying
            document.getSelection().removeAllRanges();    // Unselect everything on the HTML document
            document.getSelection().addRange(selected);   // Restore the original selection
          }

          document.getElementById('alert-notification').className += ' show';
          setTimeout(function(){
                document.getElementById('alert-notification').className = 'alert-notification';
          }, 3000);

    });
    //Копирование кода

    //Контакты
    $('.contacts_block_fon').click(function() {
        $('.contacts_block').removeClass('show_contacts');
        $('body,html').removeClass('overflow');
    });

    //Табы в метрике
    $('.metrics_tabs ul').on('click', 'li:not(.active)', function() {
        $(this)
            .addClass('active').siblings().removeClass('active')
            .closest('div.metrics_tabs').find('div.metrics_tabs_content').removeClass('active').eq($(this).index()).addClass('active');
    });
//Показать/Скрыть блок с вводом кода на странице Sign Up
    $('input#bonus_code').change(function() {
        if($(this).is(':checked')) {
            $('.bonus_row_input ').slideDown();
        } else {
            $('.bonus_row_input ').slideUp();
        }
    });

//Если выбран notification - показать тариф
    $('input.check_campaign').change(function() {
       if($(this).is(':checked')) {
           $(this).closest('.dashboard_campaign_title').next('.dashboard_choose_rate').slideDown();
       } else {
           $(this).closest('.dashboard_campaign_title').next('.dashboard_choose_rate').slideUp();
       }
    });
 
//Изменение текста выбранного тарифа и закрытие блока с тарифами

//Изменение текста в кнопке на странице affiliate
    $('.transfer_money_radio input').change(function() {
        console.log($(this).val());
        if($(this).val() == 'transfer_withdraw') {
            console.log($(this).val());
            $('.count_transfer_money button.btn_transfer_balance').removeClass('show');
            $('.count_transfer_money button.btn_transfer_withdraw').addClass('show');
        } else {
            $('.count_transfer_money button.btn_transfer_balance').addClass('show');
            $('.count_transfer_money button.btn_transfer_withdraw').removeClass('show');
        }
    });

//Открытие/закрытие блока referrals information
    $('.referrals_information_link').click(function() {
        $('.referrals_information_block').addClass('show_referrals');
        $('body,html').addClass('overflow');
        return false;
    });

    $('.referrals_block_fon').click(function() {
        $('.referrals_information_block').removeClass('show_referrals');
        $('body,html').removeClass('overflow');
    });

 //Открытие/закрытие блока payment history
    $('.payment_history_link').click(function() {
        $('.payment_history_block').addClass('show_referrals');
        $('body,html').addClass('overflow');
        return false;
    });

    $('.payment_block_fon').click(function() {
        $('.payment_history_block').removeClass('show_referrals');
        $('body,html').removeClass('overflow');
    });

//Показать/Скрыть соц иконки что бы поделиться ссылкой на странице affiliate
    $('.share_link_icon').click(function() {
       $('.share_social_block').fadeToggle('fast');
       return false;
    });
    $(document).on('click', function(e) {
        if (!$(e.target).closest(".share_link_bonus").length) {
            $('.share_social_block').fadeOut('fast');
        }
        e.stopPropagation();
    });

//Показать/Скрыть блок с вводом кода на странице Top Up
    $('input#topUp_bonus_code').change(function() {
        if($(this).is(':checked')) {
            $('.topUp_bonus_input ').slideDown('fast');
        } else {
            $('.topUp_bonus_input ').slideUp('fast');
        }
    });
  
 //Табы на странице Billing

    $('.dashboard_select_payment_item').click(function() {
       $(this).addClass('active').siblings().removeClass('active');
    });

    $('.top_up_payment_item').click(function() {

        var type = 'paypal';
        var method = $(this).data('method');

        if (method == 'paypal') {
            type = 'paypal';
        } else if (method == '2checkout') {
            type = '2checkout';
        }

        $('input[name="payment-method"]').val(type);
        $(this).addClass('active').siblings().removeClass('active');
    });

    /*$('.topUp_balance_input form button').click(function() {
        $('input[name="payment-type"]').val('custom');
        $('input[name="payment-amount"]').val($('#custom-amount').val());
        $('input[name="payment-bonus"]').val($('#custom-bonus').val());
        
        if ($('#custom-amount').val() != '') {
            $('#custom-amount').removeClass('error');
            $('.top_up_payment_modal').addClass('show_modal');            
        } else {
            $('#custom-amount').addClass('error');
        }


        return false;
    });*/

    $(document).on('keyup', '#custom-amount', function(evt){
        var charCode = (evt.which) ? evt.which : event.keyCode
        if (charCode > 31 && (charCode < 48 || charCode > 57))
            return false;
        return true;     
    });

    $('#send-payment').on('click', function(){

        var method = $('input[name="payment-method"]').val();
        if (method == '2checkout') {
            $('#checkout-form').show();
            $('.c-top_up_payment_modal').hide();
            console.log('method');
        } else {
            $('.payout_modal_preloader').fadeIn(300);
            $( "#payment-form" ).submit();
        }

        return false;
    });
 
    /*$('.topUp_link a').click(function() {
 
        $('input[name="payment-type"]').val($(this).attr('id'));
        $('input[name="payment-amount"]').val('');
        $('input[name="payment-bonus"]').val('');
        $('.topUp_link a').removeClass('active');
        $(this).addClass('active');
        $('.top_up_payment_modal').addClass('show_modal');
        return false;
    });*/

    //Скрыть модальное окно
    $('.top_up_payment_modal_fon').click(function(){
        $('.top_up_payment_modal').removeClass('show_modal');
        return false;
    });
 
    /*$('#myCCForm input[type="submit"]').on('click', function(){

        let args = {
            sellerId: "1",
            publishableKey: "B706DF94-9F86-44C8-96C2-401BEBCB647B",
            ccNo: $("#ccNo").val(),
            cvv: $("#cvv").val(),
            expMonth: $("#expMonth").val(),
            expYear: $("#expYear").val()
        };
        return false;
    });*/
 
    $('.fake_module_rules input[name="fake"]').change(function() {
        var fake_yes = $('input[name="fake"]:checked').val();
        if(fake_yes != 'no') {
            $('.fake_module_body').fadeIn('fast');
        } else {
            $('.fake_module_body').fadeOut('fast');
        }
    });

    $('.language_module_rules input[name="language"]').change(function() {
        var fake_yes = $('input[name="language"]:checked').val();
        if(fake_yes != 'no') {
            console.log('111');
            $('.language_module_body').fadeIn('fast');
        } else {
            console.log('222');
            $('.language_module_body').fadeOut('fast');
        }
    });


    $(document).on('click', '.notification_tab_switch', function() {

        const name = $(this).data('name');

        $('.notification_tab_switch').removeClass('active');
        $(this).addClass('active');

        $('.notification_tabs_content').removeClass('active');
        $('.notification_tabs_content_' + name).addClass('active');

         console.log(name);
    });

    $(document).on('click', '#domain-settings', function() {

        console.log('click');
        if ($('.popup_settings').hasClass('active')) {
            $('.popup_settings').removeClass('active');
            $('.popup_settings_fon').fadeOut();
        } else {
            $('.popup_settings').addClass('active');
            $('.popup_settings_fon').fadeIn();
        }


        return false;

    });


    $(document).on('click', '.popup_settings_fon', function() {
        $('.popup_settings').removeClass('active');
        $('.popup_settings_fon').fadeOut();
    });

})

